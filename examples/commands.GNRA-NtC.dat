# In this example, we create a hairpin with a three base pair stem and a four base loop.
# You can compare this to the tetraloop found in the large subunit of the yeast mitochondrial ribosome, PDB ID 5MRC, residues 2639 to 2648.

#sequence
RNA A 2639     UACGUAAGUA

# stages
firstStage 1 
lastStage 2

#general simulation parameters
# This is a multiplying factor for the baseInteraction forces:
baseInteractionScaleFactor     200
# Simulation time = reportingInterval * numReportingIntervals :
reportingInterval 3.0
numReportingIntervals  7 
temperature 10 

# You can impose WatsonCrick/WatsonCrick/Cis base pairing forces pulling residues 2656-2658 towards 2663-2665:
nucleicAcidDuplex A 2639 2641 A 2648 2646
# Note that in the above the first residue stretch is rising, the second is falling. This is because the strands are antiparallel. Respect this syntax!

# Or, equivalently, you can apply the base pairs individually::
#baseInteraction A 2641 WatsonCrick A 2646 WatsonCrick Cis 
#baseInteraction A 2640 WatsonCrick  A 2647 WatsonCrick Cis 
#baseInteraction A 2639 WatsonCrick  A 2648 WatsonCrick Cis

# Turn on MD forces (incl. electrostatic and Lennard Jones forces)
setDefaultMDParameters

#In prior editions of MMB we set the helical stacking using baseInteractions which could be automatically applied. This is actually still pretty useful, though if parameters change it could start to make sense to turn that off:
#setHelicalStacking False

#Why? Because now we have a better way to make nice helices. And actually many other dinucleotide steps. Thanks to Emmanuel Peter, Bohdan Schneider, and Jiri Cerny, who implemented NtCs in MMB.
#The following imposes the NtC of type AA00 -- the most typical A-form stacking dinucleotide step -- to the dinucleotide formed by residues 2656 and 2657. The last parameter is a force constant:
NtC A 2639 2640 AA00 .5
# There are three stacked bases on this strand. So we impose a second NtC force, overlapping the prior one:
NtC A 2640 2641 AA00 .5
# And now we do the same thing on the other strand:
NtC A 2646 2647 AA00 .5
NtC A 2647 2648 AA00 .5

readAtStage 2
baseInteraction A 2645 Hoogsteen A 2642 SugarEdge Trans
NtC A 2641 2642 AA00 1.5
NtC A 2643 2644 AA00 1.5
NtC A 2644 2645 AA00 1.5
readBlockEnd


